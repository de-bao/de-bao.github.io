---
layout: default
---
<div class="blog-page">
    <div class="container">
        <header class="page-header" style="text-align: center; margin-bottom: 3rem; padding-top: 2rem;">
            <h1>博客文章</h1>
            <p style="font-size: 1.1rem; margin-top: 1rem; opacity: 0.8;">分享技术见解和学习笔记</p>
        </header>

        <!-- 筛选器 -->
        <div class="blog-filters">
            <!-- 标签筛选 -->
            <div class="filter-section">
                <h3 class="filter-title">标签筛选</h3>
                <div class="tags-filter">
                    <button class="filter-btn active" data-filter="all">全部</button>
                    {% assign all_tags = '' | split: '' %}
                    {% for post in site.posts %}
                        {% for tag in post.tags %}
                            {% unless all_tags contains tag %}
                                {% assign all_tags = all_tags | push: tag %}
                            {% endunless %}
                        {% endfor %}
                    {% endfor %}
                    {% assign all_tags = all_tags | sort %}
                    {% for tag in all_tags %}
                    {% assign tag_posts = site.posts | where_exp: "post", "post.tags contains tag" %}
                    <button class="filter-btn" data-filter="tag" data-value="{{ tag | slugify }}">
                        {{ tag }} <span class="filter-count">({{ tag_posts.size }})</span>
                    </button>
                    {% endfor %}
                </div>
            </div>

            <!-- 时间筛选 -->
            <div class="filter-section">
                <h3 class="filter-title">时间筛选</h3>
                <div class="year-filter">
                    <button class="filter-btn active" data-filter="all">全部</button>
                    {% assign posts_by_year = site.posts | group_by_exp: "post", "post.date | date: '%Y'" %}
                    {% for year in posts_by_year %}
                    <button class="filter-btn" data-filter="year" data-value="{{ year.name }}">
                        {{ year.name }}年 <span class="filter-count">({{ year.items.size }})</span>
                    </button>
                    {% endfor %}
                </div>
            </div>

            <!-- 搜索框 -->
            <div class="filter-section">
                <div class="search-box">
                    <i class="fas fa-search"></i>
                    <input type="text" id="search-input" placeholder="搜索文章标题或内容..." class="search-input">
                </div>
            </div>
        </div>

        <!-- 文章列表 -->
        <div class="posts-list" id="posts-list">
            {% if site.posts.size > 0 %}
            {% for post in site.posts %}
            <article class="post-card" 
                     data-tags="{% for tag in post.tags %}{{ tag | slugify }} {% endfor %}"
                     data-year="{{ post.date | date: '%Y' }}"
                     data-title="{{ post.title | downcase }}"
                     data-content="{{ post.excerpt | strip_html | downcase }}">
                <div class="post-card-header">
                    <h2><a href="{{ post.url | relative_url }}">{{ post.title }}</a></h2>
                    <div class="post-meta">
                        <time datetime="{{ post.date | date: '%Y-%m-%d' }}">
                            <i class="far fa-calendar"></i> {{ post.date | date: "%Y年%m月%d日" }}
                        </time>
                        {% if post.tags.size > 0 %}
                        <div class="post-tags">
                            {% for tag in post.tags limit: 3 %}
                            <span class="tag" data-tag="{{ tag | slugify }}">#{{ tag }}</span>
                            {% endfor %}
                        </div>
                        {% endif %}
                    </div>
                </div>
                <div class="post-card-content">
                    {% if post.excerpt %}
                    <p>{{ post.excerpt | strip_html | truncatewords: 50 }}</p>
                    {% endif %}
                </div>
                <div class="post-card-footer">
                    <a href="{{ post.url | relative_url }}" class="read-more">阅读全文 <i class="fas fa-arrow-right"></i></a>
                </div>
            </article>
            {% endfor %}
            {% else %}
            <div style="text-align: center; padding: 4rem 0;">
                <p style="font-size: 1.2rem; color: var(--color-text-secondary);">暂无文章，敬请期待！</p>
        </div>
            {% endif %}
        </div>

        <!-- 无结果提示 -->
        <div id="no-results" style="display: none; text-align: center; padding: 4rem 0;">
            <p style="font-size: 1.2rem; color: var(--color-text-secondary);">没有找到匹配的文章</p>
            <button class="filter-btn" id="reset-filters-btn" style="margin-top: 1rem;">清除筛选</button>
        </div>
    </div>
</div>

<script>
// 筛选功能
let activeTag = 'all';
let activeYear = 'all';
let searchQuery = '';

function filterPosts() {
    const posts = document.querySelectorAll('.post-card');
    let visibleCount = 0;

    posts.forEach(post => {
        const postTags = post.getAttribute('data-tags') || '';
        const postYear = post.getAttribute('data-year') || '';
        const postTitle = post.getAttribute('data-title') || '';
        const postContent = post.getAttribute('data-content') || '';

        let show = true;

        // 标签筛选
        if (activeTag !== 'all') {
            if (!postTags.includes(activeTag)) {
                show = false;
            }
        }

        // 年份筛选
        if (activeYear !== 'all') {
            if (postYear !== activeYear) {
                show = false;
            }
        }

        // 搜索筛选
        if (searchQuery) {
            const query = searchQuery.toLowerCase();
            if (!postTitle.includes(query) && !postContent.includes(query)) {
                show = false;
            }
        }

        if (show) {
            post.style.display = 'flex';
            visibleCount++;
        } else {
            post.style.display = 'none';
        }
    });

    // 显示/隐藏无结果提示
    const noResults = document.getElementById('no-results');
    if (visibleCount === 0) {
        noResults.style.display = 'block';
    } else {
        noResults.style.display = 'none';
    }
}

// 清除筛选函数
function resetFilters() {
    activeTag = 'all';
    activeYear = 'all';
    searchQuery = '';
    
    // 重置按钮状态
    document.querySelectorAll('.filter-btn').forEach(btn => {
        btn.classList.remove('active');
        if (btn.getAttribute('data-filter') === 'all') {
            btn.classList.add('active');
        }
    });
    
    // 清空搜索框
    document.getElementById('search-input').value = '';
    
    // 重新筛选
    filterPosts();
}

// 清除筛选按钮事件
document.getElementById('reset-filters-btn')?.addEventListener('click', resetFilters);

// 标签筛选
document.querySelectorAll('[data-filter="tag"]').forEach(btn => {
    btn.addEventListener('click', function() {
        document.querySelectorAll('[data-filter="tag"], [data-filter="all"]').forEach(b => b.classList.remove('active'));
        this.classList.add('active');
        activeTag = this.getAttribute('data-value');
        filterPosts();
    });
});

// 年份筛选
document.querySelectorAll('[data-filter="year"]').forEach(btn => {
    btn.addEventListener('click', function() {
        document.querySelectorAll('[data-filter="year"], [data-filter="all"]').forEach(b => {
            if (b.closest('.year-filter')) {
                b.classList.remove('active');
            }
        });
        this.classList.add('active');
        activeYear = this.getAttribute('data-value');
        filterPosts();
    });
});

// 全部按钮 - 标签筛选
document.querySelectorAll('.tags-filter [data-filter="all"]').forEach(btn => {
    btn.addEventListener('click', function() {
        document.querySelectorAll('.tags-filter .filter-btn').forEach(b => b.classList.remove('active'));
        this.classList.add('active');
        activeTag = 'all';
        filterPosts();
    });
});

// 全部按钮 - 年份筛选
document.querySelectorAll('.year-filter [data-filter="all"]').forEach(btn => {
    btn.addEventListener('click', function() {
        document.querySelectorAll('.year-filter .filter-btn').forEach(b => b.classList.remove('active'));
        this.classList.add('active');
        activeYear = 'all';
        filterPosts();
    });
});

// 搜索功能
document.getElementById('search-input').addEventListener('input', function(e) {
    searchQuery = e.target.value.trim();
    filterPosts();
});
</script>

